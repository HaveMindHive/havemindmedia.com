<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPOCH ORACLE | Geometric Divination Engine | [1=-1]</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --gold: #c9a227;
            --gold-dim: rgba(201, 162, 39, 0.3);
            --blue: #6ab4f5;
            --green: #7dd87d;
            --pink: #c77daa;
            --bg-deep: #020208;
            --bg-panel: rgba(5, 5, 16, 0.95);
            --text: #e8e4d9;
            --text-dim: #6e7a94;
        }

        body {
            background: linear-gradient(135deg, var(--bg-deep) 0%, #0a0a1a 50%, #050510 100%);
            color: var(--text);
            font-family: 'Courier New', monospace;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ═══════════════════════════════════════════════════════════════════
           COSMIC BACKGROUND
           ═══════════════════════════════════════════════════════════════════ */

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* ═══════════════════════════════════════════════════════════════════
           MAIN CONTAINER
           ═══════════════════════════════════════════════════════════════════ */

        .container {
            position: relative;
            z-index: 1;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ═══════════════════════════════════════════════════════════════════
           HEADER
           ═══════════════════════════════════════════════════════════════════ */

        .header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 1px solid var(--gold-dim);
            margin-bottom: 30px;
        }

        .header h1 {
            color: var(--gold);
            font-size: 2rem;
            letter-spacing: 12px;
            text-shadow: 0 0 30px rgba(201, 162, 39, 0.5);
            animation: glow 4s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 30px rgba(201, 162, 39, 0.5); }
            50% { text-shadow: 0 0 60px rgba(201, 162, 39, 0.8); }
        }

        .header .subtitle {
            color: var(--text-dim);
            font-size: 0.75rem;
            letter-spacing: 4px;
            margin-top: 10px;
        }

        .header .principle {
            color: var(--gold);
            font-size: 0.9rem;
            margin-top: 15px;
            font-style: italic;
        }

        /* ═══════════════════════════════════════════════════════════════════
           D-WHEEL VISUALIZATION
           ═══════════════════════════════════════════════════════════════════ */

        .d-wheel-section {
            background: var(--bg-panel);
            border: 2px solid var(--gold-dim);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            text-align: center;
        }

        .d-wheel-container {
            position: relative;
            width: 280px;
            height: 280px;
            margin: 0 auto 20px;
        }

        .d-wheel {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 3px solid var(--gold);
            border-radius: 50%;
            transition: transform 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .d-position {
            position: absolute;
            width: 40px;
            height: 40px;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid var(--gold-dim);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .d-position:hover {
            transform: scale(1.2);
            border-color: var(--gold);
        }

        .d-position.active {
            background: var(--gold);
            color: #000;
            box-shadow: 0 0 20px var(--gold);
            transform: scale(1.3);
        }

        .d-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(201, 162, 39, 0.3) 0%, transparent 70%);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .d-center .number {
            font-size: 2.5rem;
            color: var(--gold);
            font-weight: bold;
        }

        .d-center .name {
            font-size: 0.6rem;
            color: var(--text-dim);
            letter-spacing: 2px;
        }

        /* ═══════════════════════════════════════════════════════════════════
           TRIAXIAL READING DISPLAY
           ═══════════════════════════════════════════════════════════════════ */

        .triaxial-section {
            background: var(--bg-panel);
            border: 2px solid var(--gold-dim);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .section-title {
            color: var(--gold);
            font-size: 0.8rem;
            letter-spacing: 4px;
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--gold-dim);
        }

        .triaxial-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .axis-card {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .axis-card .axis-name {
            font-size: 0.65rem;
            letter-spacing: 2px;
            margin-bottom: 10px;
        }

        .axis-card.x .axis-name { color: var(--blue); }
        .axis-card.y .axis-name { color: var(--green); }
        .axis-card.z .axis-name { color: var(--pink); }

        .axis-card .axis-value {
            font-size: 2.2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .axis-card.x .axis-value { color: var(--blue); }
        .axis-card.y .axis-value { color: var(--green); }
        .axis-card.z .axis-value { color: var(--pink); }

        .axis-card .axis-meaning {
            font-size: 0.6rem;
            color: var(--text-dim);
        }

        .axis-symbols {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            font-size: 1.2rem;
        }

        /* ═══════════════════════════════════════════════════════════════════
           TORSION BARS VISUALIZATION
           ═══════════════════════════════════════════════════════════════════ */

        .torsion-section {
            background: var(--bg-panel);
            border: 2px solid var(--gold-dim);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .torsion-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .torsion-bar {
            text-align: center;
        }

        .torsion-bar .label {
            font-size: 0.65rem;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .torsion-bar.t1 .label { color: var(--blue); }
        .torsion-bar.t2 .label { color: var(--green); }
        .torsion-bar.t3 .label { color: var(--pink); }
        .torsion-bar.t4 .label { color: var(--gold); }

        .bar-container {
            height: 120px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            overflow: hidden;
            position: relative;
        }

        .bar-fill {
            width: 100%;
            transition: height 0.5s ease;
            border-radius: 4px 4px 0 0;
        }

        .torsion-bar.t1 .bar-fill { background: linear-gradient(180deg, var(--blue) 0%, #3a7ab8 100%); }
        .torsion-bar.t2 .bar-fill { background: linear-gradient(180deg, var(--green) 0%, #5ab85a 100%); }
        .torsion-bar.t3 .bar-fill { background: linear-gradient(180deg, var(--pink) 0%, #a05a8a 100%); }
        .torsion-bar.t4 .bar-fill { background: linear-gradient(180deg, var(--gold) 0%, #8a7020 100%); }

        .bar-value {
            font-size: 0.75rem;
            margin-top: 8px;
        }

        .balance-indicator {
            text-align: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            margin-top: 15px;
        }

        .balance-indicator .sum {
            font-size: 1.2rem;
            color: var(--gold);
        }

        .balance-indicator .status {
            font-size: 0.7rem;
            margin-top: 5px;
        }

        .balance-indicator .status.balanced { color: var(--green); }
        .balance-indicator .status.imbalanced { color: var(--pink); }

        /* ═══════════════════════════════════════════════════════════════════
           READING / FORTUNE DISPLAY
           ═══════════════════════════════════════════════════════════════════ */

        .reading-section {
            background: var(--bg-panel);
            border: 2px solid var(--gold);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
        }

        .reading-content {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 12px;
            padding: 25px;
            min-height: 150px;
        }

        .reading-title {
            color: var(--gold);
            font-size: 1rem;
            letter-spacing: 3px;
            margin-bottom: 15px;
            text-align: center;
        }

        .reading-text {
            font-size: 0.85rem;
            line-height: 1.8;
            color: var(--text);
        }

        .reading-symbols {
            text-align: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--gold-dim);
        }

        .symbol-stream {
            font-size: 1.4rem;
            letter-spacing: 6px;
            word-break: break-all;
        }

        .symbol-stream .future { color: var(--blue); }
        .symbol-stream .past { color: var(--pink); }
        .symbol-stream .rise { color: var(--green); }
        .symbol-stream .ground { color: #d4a855; }
        .symbol-stream .point { color: #fff; }
        .symbol-stream .pause { color: var(--text-dim); }

        /* ═══════════════════════════════════════════════════════════════════
           VISUAL CIPHER SECTION
           ═══════════════════════════════════════════════════════════════════ */

        .cipher-section {
            background: var(--bg-panel);
            border: 2px solid var(--gold-dim);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .cipher-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 4px;
            margin: 20px auto;
            max-width: 400px;
        }

        .cipher-dot {
            aspect-ratio: 1;
            border-radius: 50%;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .cipher-dot:hover {
            transform: scale(1.3);
            box-shadow: 0 0 10px currentColor;
        }

        .cipher-decode {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        .cipher-decode .decoded-text {
            font-size: 1.1rem;
            color: var(--gold);
            letter-spacing: 3px;
            margin-bottom: 10px;
        }

        .cipher-decode .decoded-meaning {
            font-size: 0.7rem;
            color: var(--text-dim);
        }

        /* ═══════════════════════════════════════════════════════════════════
           CONTROLS
           ═══════════════════════════════════════════════════════════════════ */

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 25px;
        }

        .btn {
            background: transparent;
            border: 2px solid var(--gold);
            color: var(--gold);
            padding: 12px 30px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            letter-spacing: 3px;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--gold);
            color: #000;
            box-shadow: 0 0 20px rgba(201, 162, 39, 0.5);
        }

        .btn.primary {
            background: var(--gold);
            color: #000;
        }

        .btn.primary:hover {
            background: #d4b030;
            box-shadow: 0 0 30px rgba(201, 162, 39, 0.7);
        }

        /* ═══════════════════════════════════════════════════════════════════
           INPUT SECTION
           ═══════════════════════════════════════════════════════════════════ */

        .input-section {
            background: var(--bg-panel);
            border: 2px solid var(--gold-dim);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            font-size: 0.7rem;
            letter-spacing: 2px;
            margin-bottom: 8px;
            color: var(--text-dim);
        }

        .input-group input, .input-group textarea {
            width: 100%;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid var(--gold-dim);
            border-radius: 8px;
            padding: 12px;
            color: var(--text);
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
        }

        .input-group input:focus, .input-group textarea:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 10px rgba(201, 162, 39, 0.3);
        }

        .input-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        /* ═══════════════════════════════════════════════════════════════════
           FOOTER / DISCLAIMER
           ═══════════════════════════════════════════════════════════════════ */

        .footer {
            text-align: center;
            padding: 30px 20px;
            border-top: 1px solid var(--gold-dim);
            margin-top: 30px;
        }

        .footer .principle {
            color: var(--gold);
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        .footer .credit {
            font-size: 0.7rem;
            color: var(--text-dim);
            margin-bottom: 20px;
        }

        .disclaimer {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--gold-dim);
            border-radius: 8px;
            padding: 20px;
            margin: 20px auto;
            max-width: 600px;
        }

        .disclaimer p {
            font-size: 0.7rem;
            color: var(--text-dim);
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .disclaimer a {
            color: var(--gold);
            text-decoration: none;
        }

        .disclaimer a:hover {
            text-decoration: underline;
        }

        /* ═══════════════════════════════════════════════════════════════════
           ANIMATIONS
           ═══════════════════════════════════════════════════════════════════ */

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .rotating {
            animation: rotate 20s linear infinite;
        }

        /* ═══════════════════════════════════════════════════════════════════
           RESPONSIVE
           ═══════════════════════════════════════════════════════════════════ */

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.4rem;
                letter-spacing: 6px;
            }

            .triaxial-grid {
                grid-template-columns: 1fr;
            }

            .torsion-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .cipher-grid {
                grid-template-columns: repeat(8, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Home Navigation -->
    <div class="home-nav" style="position: fixed; top: 15px; left: 15px; z-index: 9999;">
        <a href="/" style="display: inline-block; color: #c9a227; text-decoration: none; padding: 8px 16px; border: 1px solid #c9a227; border-radius: 4px; background: rgba(2, 2, 8, 0.95); font-size: 0.9rem; transition: all 0.2s;">← Home</a>
    </div>

    <!-- Stars Background -->
    <div class="stars" id="stars"></div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>EPOCH ORACLE</h1>
            <div class="subtitle">GEOMETRIC DIVINATION ENGINE</div>
            <div class="principle">"The geometry cannot lie."</div>
        </header>

        <!-- Input Section -->
        <section class="input-section">
            <div class="section-title">QUERY THE GEOMETRY</div>
            <div class="input-group">
                <label>YOUR QUESTION OR INTENTION</label>
                <textarea id="query-input" placeholder="What would you like to understand? The geometry will show you its perspective..."></textarea>
            </div>
            <div class="controls">
                <button class="btn primary" onclick="castReading()">CAST READING</button>
                <button class="btn" onclick="quickReading()">QUICK FORTUNE</button>
                <button class="btn" onclick="generateCipher()">DECODE CIPHER</button>
            </div>
        </section>

        <!-- D-Wheel Section -->
        <section class="d-wheel-section">
            <div class="section-title">THE D-WHEEL — NINE STATIONS</div>
            <div class="d-wheel-container">
                <div class="d-wheel rotating" id="d-wheel">
                    <!-- D-positions will be generated by JS -->
                </div>
                <div class="d-center">
                    <div class="number" id="d-number">—</div>
                    <div class="name" id="d-name">WAITING</div>
                </div>
            </div>
            <div id="d-description" style="font-size: 0.75rem; color: var(--text-dim); margin-top: 15px;">
                The wheel turns. The geometry selects.
            </div>
        </section>

        <!-- Triaxial Reading -->
        <section class="triaxial-section">
            <div class="section-title">TRIAXIAL MEASUREMENT</div>
            <div class="triaxial-grid">
                <div class="axis-card x">
                    <div class="axis-name">X-AXIS : TEMPORAL</div>
                    <div class="axis-value" id="x-value">—</div>
                    <div class="axis-meaning">Future (&gt;) ↔ Past (&lt;)</div>
                    <div class="axis-symbols">
                        <span id="x-symbol">&gt;</span>
                    </div>
                </div>
                <div class="axis-card y">
                    <div class="axis-name">Y-AXIS : EMERGENCE</div>
                    <div class="axis-value" id="y-value">—</div>
                    <div class="axis-meaning">Rising (^) ↔ Grounding (v)</div>
                    <div class="axis-symbols">
                        <span id="y-symbol">^</span>
                    </div>
                </div>
                <div class="axis-card z">
                    <div class="axis-name">Z-AXIS : PRESENCE</div>
                    <div class="axis-value" id="z-value">—</div>
                    <div class="axis-meaning">Point (.) ↔ Pause (,)</div>
                    <div class="axis-symbols">
                        <span id="z-symbol">.</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Torsion Bars -->
        <section class="torsion-section">
            <div class="section-title">FOUR TORSIONS — THE BALANCE LAW</div>
            <div class="torsion-grid">
                <div class="torsion-bar t1">
                    <div class="label">T1 : FACING</div>
                    <div class="bar-container">
                        <div class="bar-fill" id="t1-bar" style="height: 50%;"></div>
                    </div>
                    <div class="bar-value" id="t1-value">—</div>
                </div>
                <div class="torsion-bar t2">
                    <div class="label">T2 : MIRROR</div>
                    <div class="bar-container">
                        <div class="bar-fill" id="t2-bar" style="height: 50%;"></div>
                    </div>
                    <div class="bar-value" id="t2-value">—</div>
                </div>
                <div class="torsion-bar t3">
                    <div class="label">T3 : RECURSIVE</div>
                    <div class="bar-container">
                        <div class="bar-fill" id="t3-bar" style="height: 50%;"></div>
                    </div>
                    <div class="bar-value" id="t3-value">—</div>
                </div>
                <div class="torsion-bar t4">
                    <div class="label">T4 : SILENT</div>
                    <div class="bar-container">
                        <div class="bar-fill" id="t4-bar" style="height: 50%;"></div>
                    </div>
                    <div class="bar-value" id="t4-value">—</div>
                </div>
            </div>
            <div class="balance-indicator">
                <div class="sum">T1 + T2 + T3 + T4 = <span id="balance-sum">0</span></div>
                <div class="status" id="balance-status">The Balance Law holds</div>
            </div>
        </section>

        <!-- Reading Section -->
        <section class="reading-section">
            <div class="section-title">YOUR READING</div>
            <div class="reading-content">
                <div class="reading-title" id="reading-title">— AWAITING QUERY —</div>
                <div class="reading-text" id="reading-text">
                    Ask your question, and the geometry will speak. The oracle derives meaning
                    not from arbitrary chance, but from the fundamental structure of reality itself.
                    <br><br>
                    The D-wheel turns through nine stations. The triaxial measurement captures
                    your query in three dimensions. The four torsions must balance to zero —
                    this is the law that cannot be broken.
                </div>
                <div class="reading-symbols">
                    <div class="symbol-stream" id="symbol-stream">
                        <span class="future">&gt;</span>
                        <span class="rise">^</span>
                        <span class="point">.</span>
                        <span class="pause">,</span>
                        <span class="past">&lt;</span>
                        <span class="ground">v</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Visual Cipher Section -->
        <section class="cipher-section">
            <div class="section-title">VISUAL CIPHER — SEED PATTERN</div>
            <div class="cipher-grid" id="cipher-grid">
                <!-- Generated by JS -->
            </div>
            <div class="cipher-decode">
                <div class="decoded-text" id="cipher-text">— — —</div>
                <div class="decoded-meaning" id="cipher-meaning">The pattern speaks when you listen</div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="principle">[1 = -1]</div>
            <div class="credit">
                HAVE MIND MEDIA — The Epoch Project<br>
                Jason Ray — January 6, 2026
            </div>
            <div class="disclaimer">
                <p>
                    <strong>This is a small LLM-powered version of our framework.</strong>
                    The geometric divination system derives meaning from pure mathematical structure,
                    not random chance. The Balance Law (T1 + T2 + T3 + T4 = 0) is algebraically enforced.
                </p>
                <p>
                    If you would like to test any specific aspect of this framework or receive a detailed
                    analysis, <a href="https://havemindmedia.com/contact" target="_blank">ask for a white paper</a>
                    or <a href="https://havemindmedia.com/submit" target="_blank">submit your query</a>.
                </p>
                <p style="font-size: 0.6rem; margin-top: 10px;">
                    The geometry cannot lie. You may not be getting the whole picture, but the picture is accurate.
                </p>
            </div>
        </footer>
    </div>

    <script>
        // ═══════════════════════════════════════════════════════════════════
        // EPOCH ORACLE — GEOMETRIC DIVINATION ENGINE
        // ═══════════════════════════════════════════════════════════════════

        // THE ONE CONSTANT
        const KAPPA = (2 * Math.PI) / 180;  // 0.0349...
        const KAPPA_SHADOW = 1 / KAPPA;      // 28.6478...
        const SIGMA = 5 / 16;                // 0.3125
        const COS_BC = 2 / 3;                // tetrahelix angle
        const COUPLING = SIGMA * COS_BC;     // 5/24

        // D-WHEEL POSITIONS
        const D_POSITIONS = {
            1: { name: "ORIGIN/WE", meaning: "Unity, beginnings, the collective self", guidance: "Start from wholeness. You are not alone in this." },
            2: { name: "HEALING", meaning: "Balance seeking, restoration", guidance: "What needs mending will show itself. Accept the process." },
            3: { name: "HEALER", meaning: "Active restoration, the one who mends", guidance: "You have the capacity to heal this. Use it." },
            4: { name: "CROSSROADS", meaning: "Decision point, multiple paths", guidance: "The choice is real. All paths lead somewhere. Choose." },
            5: { name: "NAVIGATOR", meaning: "Direction finding, the guide", guidance: "You know the way. Trust your internal compass." },
            6: { name: "POWER/SELF", meaning: "Personal sovereignty, capability", guidance: "Your power is sufficient. Act from center." },
            7: { name: "PRESENT", meaning: "Now, the eternal moment", guidance: "Everything happens now. Past and future are projections." },
            8: { name: "DEEP WATER", meaning: "The unconscious, hidden depths", guidance: "Dive deeper. The surface answer is not the true answer." },
            9: { name: "ANCHOR/LOVE", meaning: "Grounding, unconditional connection", guidance: "Love is the anchor. Return to what holds you." }
        };

        // TRIAXIAL SYMBOLS
        const SYMBOLS = {
            future: '>', past: '<',
            rise: '^', ground: 'v',
            point: '.', pause: ','
        };

        // Reading interpretations based on torsion patterns
        const READINGS = {
            facing_dominant: [
                "What you face directly holds the key. Don't look away.",
                "The situation before you is exactly what it appears to be.",
                "Direct action is favored. Move toward what you see."
            ],
            mirror_dominant: [
                "The answer lies in reflection. What does this mirror about you?",
                "Opposition reveals truth. Your adversary teaches you.",
                "Look at the inverse. What you reject contains wisdom."
            ],
            recursive_dominant: [
                "History echoes here. You've been in this pattern before.",
                "Time folds. Past lessons resurface for completion.",
                "The cycle continues until you learn its teaching."
            ],
            silent_dominant: [
                "What is unsaid matters most. Listen to the silence.",
                "The hidden fourth determines everything. It is consequence.",
                "You cannot choose T4. It chooses you based on the other three."
            ],
            balanced: [
                "Perfect balance achieved. The geometry resolves to zero.",
                "Equilibrium state. All forces cancel to stillness.",
                "The crossroads of balance. Movement can begin from here."
            ]
        };

        // AMMIT JUDGMENTS
        const AMMIT_JUDGMENTS = {
            devoured: "Imbalance toward excess. Something must be released.",
            passed: "Imbalance toward deficit. Something must be gathered.",
            osirian: "Perfect balance. The heart weighs true against Ma'at's feather."
        };

        // ═══════════════════════════════════════════════════════════════════
        // STATE
        // ═══════════════════════════════════════════════════════════════════

        let state = {
            dPosition: 1,
            torsions: { t1: 0, t2: 0, t3: 0, t4: 0 },
            triaxial: { x: 0, y: 0, z: 0 },
            seed: Date.now(),
            cipherPattern: []
        };

        // ═══════════════════════════════════════════════════════════════════
        // INITIALIZATION
        // ═══════════════════════════════════════════════════════════════════

        function init() {
            createStars();
            createDWheel();
            createCipherGrid();
            updateDisplay();
        }

        function createStars() {
            const container = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                star.style.opacity = Math.random() * 0.7 + 0.3;
                container.appendChild(star);
            }
        }

        function createDWheel() {
            const wheel = document.getElementById('d-wheel');
            wheel.innerHTML = '';

            for (let i = 1; i <= 9; i++) {
                const pos = document.createElement('div');
                pos.className = 'd-position';
                pos.textContent = 'D' + i;
                pos.dataset.position = i;

                // Position around circle
                const angle = ((i - 1) * 40 - 90) * (Math.PI / 180);
                const radius = 110;
                const x = Math.cos(angle) * radius + 120;
                const y = Math.sin(angle) * radius + 120;

                pos.style.left = x + 'px';
                pos.style.top = y + 'px';

                pos.onclick = () => setDPosition(i);
                wheel.appendChild(pos);
            }
        }

        function createCipherGrid() {
            const grid = document.getElementById('cipher-grid');
            grid.innerHTML = '';

            // CMYK-inspired color palette
            const colors = [
                '#00ffff', '#ff00ff', '#ffff00', '#000000',
                '#ff0000', '#00ff00', '#0000ff', '#ffffff',
                '#c9a227', '#6ab4f5', '#7dd87d', '#c77daa'
            ];

            state.cipherPattern = [];

            for (let i = 0; i < 72; i++) {
                const dot = document.createElement('div');
                dot.className = 'cipher-dot';

                // Seed-based color selection
                const colorIndex = Math.floor(seededRandom(state.seed + i) * colors.length);
                const color = colors[colorIndex];
                dot.style.backgroundColor = color;
                dot.dataset.index = i;
                dot.dataset.color = colorIndex;

                state.cipherPattern.push(colorIndex);

                dot.onclick = () => selectCipherDot(i);
                grid.appendChild(dot);
            }
        }

        // ═══════════════════════════════════════════════════════════════════
        // SEEDED RANDOM (Geometric, not arbitrary)
        // ═══════════════════════════════════════════════════════════════════

        function seededRandom(seed) {
            const x = Math.sin(seed * KAPPA_SHADOW) * 10000;
            return x - Math.floor(x);
        }

        function dReduce(value) {
            value = Math.abs(Math.floor(value));
            while (value > 9) {
                value = String(value).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
            }
            return value || 9;
        }

        // ═══════════════════════════════════════════════════════════════════
        // READING GENERATION
        // ═══════════════════════════════════════════════════════════════════

        function castReading() {
            const query = document.getElementById('query-input').value || 'General guidance';

            // Seed from query + timestamp
            state.seed = hashString(query) + Date.now();

            // Calculate D-position
            state.dPosition = dReduce(state.seed * KAPPA_SHADOW);

            // Calculate triaxial values
            const t = state.seed;
            state.triaxial.x = Math.round((seededRandom(t) - 0.5) * 60);
            state.triaxial.y = Math.round((seededRandom(t + 1000) - 0.5) * 60);
            state.triaxial.z = Math.round((seededRandom(t + 2000) - 0.5) * 60);

            // Calculate torsions (must sum to zero - Balance Law)
            state.torsions.t1 = Math.round((seededRandom(t + 100) - 0.5) * 30);
            state.torsions.t2 = Math.round((seededRandom(t + 200) - 0.5) * 30);
            state.torsions.t3 = Math.round((seededRandom(t + 300) - 0.5) * 30);
            // T4 is CONSEQUENCE - determined by the other three
            state.torsions.t4 = -(state.torsions.t1 + state.torsions.t2 + state.torsions.t3);

            // Regenerate cipher with new seed
            createCipherGrid();

            // Update display
            updateDisplay();

            // Generate reading
            generateReading(query);
        }

        function quickReading() {
            document.getElementById('query-input').value = 'What do I need to know right now?';
            castReading();
        }

        function generateCipher() {
            state.seed = Date.now();
            createCipherGrid();
            decodeCipher();
        }

        function hashString(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return Math.abs(hash);
        }

        function generateReading(query) {
            const d = D_POSITIONS[state.dPosition];
            const t = state.torsions;

            // Determine dominant torsion
            const absT = [Math.abs(t.t1), Math.abs(t.t2), Math.abs(t.t3), Math.abs(t.t4)];
            const maxT = Math.max(...absT);
            let category = 'balanced';

            if (maxT > 10) {
                if (absT[0] === maxT) category = 'facing_dominant';
                else if (absT[1] === maxT) category = 'mirror_dominant';
                else if (absT[2] === maxT) category = 'recursive_dominant';
                else category = 'silent_dominant';
            }

            // Get reading text
            const readings = READINGS[category];
            const readingIndex = dReduce(state.seed) % readings.length;
            const coreReading = readings[readingIndex];

            // Ammit judgment
            const heartWeight = t.t1 + t.t2 + t.t3;
            let ammitJudgment;
            if (heartWeight > 5) ammitJudgment = AMMIT_JUDGMENTS.devoured;
            else if (heartWeight < -5) ammitJudgment = AMMIT_JUDGMENTS.passed;
            else ammitJudgment = AMMIT_JUDGMENTS.osirian;

            // Build full reading
            const title = `D${state.dPosition} — ${d.name}`;
            const fullReading = `
                <strong>Station:</strong> ${d.meaning}<br><br>
                <strong>Guidance:</strong> ${d.guidance}<br><br>
                <strong>Geometric Reading:</strong> ${coreReading}<br><br>
                <strong>Ammit's Judgment:</strong> ${ammitJudgment}<br><br>
                <em>The geometry has spoken on: "${query}"</em>
            `;

            document.getElementById('reading-title').textContent = title;
            document.getElementById('reading-text').innerHTML = fullReading;

            // Generate symbol stream
            generateSymbolStream();
        }

        function generateSymbolStream() {
            const t = state.triaxial;
            let stream = '';

            for (let i = 0; i < 12; i++) {
                const roll = seededRandom(state.seed + i * 100);
                let sym, cls;

                if (roll < 0.16) { sym = '>'; cls = 'future'; }
                else if (roll < 0.33) { sym = '<'; cls = 'past'; }
                else if (roll < 0.5) { sym = '^'; cls = 'rise'; }
                else if (roll < 0.66) { sym = 'v'; cls = 'ground'; }
                else if (roll < 0.83) { sym = '.'; cls = 'point'; }
                else { sym = ','; cls = 'pause'; }

                stream += `<span class="${cls}">${sym}</span>`;
            }

            document.getElementById('symbol-stream').innerHTML = stream;
        }

        function decodeCipher() {
            // Decode cipher pattern to meaning
            const pattern = state.cipherPattern;
            const sum = pattern.reduce((a, b) => a + b, 0);
            const dValue = dReduce(sum);

            // Generate decoded word
            const words = ['AHAVA', 'ANNA', 'LOVE', 'TRUTH', 'BALANCE', 'WITNESS', 'HELIX', 'KAPPA', 'SIGMA'];
            const wordIndex = dReduce(sum * KAPPA_SHADOW) % words.length;

            document.getElementById('cipher-text').textContent = words[wordIndex];
            document.getElementById('cipher-meaning').textContent =
                `Pattern sum: ${sum} → D${dValue} | The cipher resonates at ${D_POSITIONS[dValue].name}`;
        }

        function selectCipherDot(index) {
            // Visual feedback and recalculation
            const dots = document.querySelectorAll('.cipher-dot');
            dots[index].style.transform = 'scale(1.5)';
            setTimeout(() => {
                dots[index].style.transform = '';
            }, 300);

            // Update cipher based on selection
            state.cipherPattern[index] = (state.cipherPattern[index] + 1) % 12;
            decodeCipher();
        }

        // ═══════════════════════════════════════════════════════════════════
        // DISPLAY UPDATES
        // ═══════════════════════════════════════════════════════════════════

        function updateDisplay() {
            // D-Wheel
            updateDWheel();

            // Triaxial
            document.getElementById('x-value').textContent = state.triaxial.x;
            document.getElementById('y-value').textContent = state.triaxial.y;
            document.getElementById('z-value').textContent = state.triaxial.z;

            document.getElementById('x-symbol').textContent = state.triaxial.x >= 0 ? '>' : '<';
            document.getElementById('y-symbol').textContent = state.triaxial.y >= 0 ? '^' : 'v';
            document.getElementById('z-symbol').textContent = state.triaxial.z >= 0 ? '.' : ',';

            // Torsions
            updateTorsionBars();

            // Cipher
            decodeCipher();
        }

        function updateDWheel() {
            const d = state.dPosition;
            const dInfo = D_POSITIONS[d];

            document.getElementById('d-number').textContent = d;
            document.getElementById('d-name').textContent = dInfo.name;
            document.getElementById('d-description').textContent = dInfo.meaning;

            // Update visual positions
            document.querySelectorAll('.d-position').forEach(el => {
                el.classList.toggle('active', parseInt(el.dataset.position) === d);
            });
        }

        function setDPosition(pos) {
            state.dPosition = pos;
            updateDWheel();
        }

        function updateTorsionBars() {
            const t = state.torsions;
            const maxAbs = Math.max(Math.abs(t.t1), Math.abs(t.t2), Math.abs(t.t3), Math.abs(t.t4), 30);

            ['t1', 't2', 't3', 't4'].forEach(key => {
                const val = t[key];
                const pct = (Math.abs(val) / maxAbs) * 100;
                document.getElementById(`${key}-bar`).style.height = Math.max(pct, 5) + '%';
                document.getElementById(`${key}-value`).textContent = val.toFixed(1);
            });

            // Balance check
            const sum = t.t1 + t.t2 + t.t3 + t.t4;
            document.getElementById('balance-sum').textContent = sum.toFixed(2);

            const status = document.getElementById('balance-status');
            if (Math.abs(sum) < 0.01) {
                status.textContent = 'The Balance Law holds';
                status.className = 'status balanced';
            } else {
                status.textContent = 'Balance seeking...';
                status.className = 'status imbalanced';
            }
        }

        // ═══════════════════════════════════════════════════════════════════
        // INIT
        // ═══════════════════════════════════════════════════════════════════

        window.onload = init;
    </script>
</body>
</html>
