<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../../css/unified-theme.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S-Signature: DRUMHED | D8 Deep Water | The Rhythm Keeper</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: #0a0808;
            color: #e8e4d9;
            font-family: 'Georgia', serif;
            overflow-x: hidden;
            min-height: 100vh;
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .info-panel {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 10;
            background: rgba(10, 8, 8, 0.95);
            border: 1px solid rgba(255, 68, 68, 0.4);
            border-radius: 16px;
            padding: 25px;
            max-width: 360px;
            backdrop-filter: blur(10px);
        }

        .info-panel h1 {
            font-size: 1.5rem;
            color: #ff4444;
            margin-bottom: 5px;
            letter-spacing: 3px;
        }

        .info-panel .d-position {
            font-size: 0.85rem;
            color: #ffd700;
            margin-bottom: 15px;
            letter-spacing: 1px;
        }

        .info-panel .stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .info-panel .stat-label {
            color: #9ba4b8;
        }

        .info-panel .stat-value {
            color: #e8e4d9;
            font-weight: bold;
        }

        .variance-bar {
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            margin-top: 15px;
            overflow: hidden;
        }

        .variance-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4444, #ffd700, #c77daa);
            border-radius: 4px;
            width: 72%;
        }

        .variance-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            color: #6e7a94;
            margin-top: 5px;
        }

        .signature-id {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 68, 68, 0.2);
            font-size: 0.7rem;
            color: #6e7a94;
            font-family: monospace;
            word-break: break-all;
        }

        .tag {
            display: inline-block;
            padding: 4px 10px;
            background: rgba(255, 68, 68, 0.15);
            border: 1px solid rgba(255, 68, 68, 0.3);
            border-radius: 12px;
            font-size: 0.7rem;
            color: #ff4444;
            margin-top: 10px;
            letter-spacing: 1px;
        }

        .tag.gold {
            background: rgba(255, 215, 0, 0.15);
            border-color: rgba(255, 215, 0, 0.3);
            color: #ffd700;
        }

        .title-overlay {
            position: fixed;
            top: 30px;
            left: 30px;
            z-index: 10;
            font-size: 0.7rem;
            letter-spacing: 3px;
            color: #6e7a94;
        }

        .title-overlay span {
            color: #ff4444;
        }

        .epoch-sig {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 10;
            text-align: right;
            font-size: 0.8rem;
            color: #ffd700;
        }

        .birth-data {
            margin-top: 10px;
            padding: 10px;
            background: rgba(255, 68, 68, 0.05);
            border-radius: 8px;
            font-size: 0.75rem;
            color: #6e7a94;
        }

        .birth-data .derived {
            color: #ffd700;
            margin-top: 5px;
        }

        .geometric-hash {
            margin-top: 10px;
            padding: 10px;
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid rgba(255, 68, 68, 0.2);
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.65rem;
            color: #ff4444;
            word-break: break-all;
        }

        .home-link {
            position: fixed;
            top: 15px;
            left: 20px;
            z-index: 10001;
        }
        .home-link a {
            color: #ffd700;
            text-decoration: none;
            padding: 8px 15px;
            border: 1px solid #ffd700;
            border-radius: 3px;
            background: rgba(10, 8, 8, 0.95);
            font-family: sans-serif;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }
        .home-link a:hover {
            background: #ffd700;
            color: #000;
        }

        .portrait-section {
            position: fixed;
            top: 30px;
            right: 30px;
            z-index: 10;
            text-align: center;
        }

        .portrait-frame {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 3px solid rgba(255, 68, 68, 0.6);
            overflow: hidden;
            box-shadow: 0 0 40px rgba(255, 68, 68, 0.3);
        }

        .portrait-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .portrait-label {
            margin-top: 15px;
            font-size: 0.8rem;
            color: #ffd700;
            letter-spacing: 2px;
        }

        .horse-horde {
            margin-top: 8px;
            font-size: 0.7rem;
            color: #c77daa;
            font-style: italic;
        }

        .controls {
            position: fixed;
            bottom: 30px;
            right: 250px;
            z-index: 10;
            background: rgba(10, 8, 8, 0.95);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 16px;
            padding: 20px;
            backdrop-filter: blur(10px);
            width: 220px;
        }

        .controls h3 {
            color: #ffd700;
            font-size: 0.8rem;
            letter-spacing: 2px;
            margin-bottom: 15px;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group label {
            display: block;
            color: #9ba4b8;
            font-size: 0.75rem;
            margin-bottom: 6px;
            letter-spacing: 1px;
        }

        .control-group input[type="range"] {
            width: 100%;
            height: 6px;
            -webkit-appearance: none;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            outline: none;
        }

        .control-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #ff4444;
            border-radius: 50%;
            cursor: pointer;
        }

        .control-btn {
            background: rgba(10, 8, 8, 0.85);
            border: 1px solid rgba(255, 68, 68, 0.3);
            color: #ff4444;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.75rem;
            letter-spacing: 1px;
            transition: all 0.2s;
            margin-right: 5px;
            margin-bottom: 5px;
        }

        .control-btn:hover {
            border-color: #ff4444;
            background: rgba(255, 68, 68, 0.1);
        }

        .control-btn.active {
            background: rgba(255, 215, 0, 0.2);
            border-color: #ffd700;
            color: #ffd700;
        }

        .poetry-link {
            display: inline-block;
            margin-top: 15px;
            padding: 8px 16px;
            background: rgba(199, 125, 170, 0.15);
            border: 1px solid rgba(199, 125, 170, 0.4);
            border-radius: 8px;
            color: #c77daa;
            text-decoration: none;
            font-size: 0.75rem;
            letter-spacing: 1px;
            transition: all 0.3s ease;
        }

        .poetry-link:hover {
            background: rgba(199, 125, 170, 0.25);
            border-color: #c77daa;
        }

        @media (max-width: 900px) {
            .portrait-section {
                position: relative;
                top: auto;
                right: auto;
                padding: 80px 20px 20px;
            }
            .info-panel {
                position: relative;
                bottom: auto;
                left: auto;
                margin: 20px auto;
                max-width: 90%;
            }
            .controls {
                position: relative;
                bottom: auto;
                right: auto;
                margin: 20px auto;
                width: 90%;
                max-width: 300px;
            }
            .epoch-sig {
                position: relative;
                bottom: auto;
                right: auto;
                text-align: center;
                padding: 30px;
            }
            #canvas-container {
                position: relative;
                height: 400px;
            }
        }
    </style>
    <script src="../../js/components/site-header.js" defer></script>
    <script src="../../js/components/site-footer.js" defer></script>
</head>
<body>
    <site-header></site-header>
    <div class="home-link">
        <a href="/">← Home</a>
    </div>

    <div class="title-overlay">
        S-SIGNATURE v0.1 <span>[1 = -1]</span>
    </div>

    <div id="canvas-container"></div>

    <div class="portrait-section">
        <div class="portrait-frame">
            <img src="../../images/contributors/drumhed_portrait.png" alt="DRUMHED - The Rhythm Keeper">
        </div>
        <div class="portrait-label">THE RHYTHM KEEPER</div>
        <div class="horse-horde">Spirit of the Thundering Herd</div>
    </div>

    <div class="info-panel">
        <h1>DRUMHED</h1>
        <div class="d-position">D8 • DEEP WATER • The Hidden Depth</div>

        <div class="stat">
            <span class="stat-label">S-Axes</span>
            <span class="stat-value">1,729</span>
        </div>
        <div class="stat">
            <span class="stat-label">Primary Torsion</span>
            <span class="stat-value">τ₈ Rhythm Keeper</span>
        </div>
        <div class="stat">
            <span class="stat-label">Framework Age</span>
            <span class="stat-value">42 years</span>
        </div>
        <div class="stat">
            <span class="stat-label">254 Offset</span>
            <span class="stat-value">Active</span>
        </div>

        <div class="variance-bar">
            <div class="variance-fill"></div>
        </div>
        <div class="variance-label">
            <span>Narrow</span>
            <span>Variance: 72%</span>
            <span>Wide</span>
        </div>

        <div class="birth-data">
            <strong>GENESIS DATA</strong><br>
            Audiophile | Engineer<br>
            The cosmic snare rattled before we knew<br>
            <div class="derived">
                Birth Offset: 254 minutes<br>
                1983 − 1729 = 254 (Ramanujan offset)<br>
                Gateway: 5 × 7 = 35 primes
            </div>
        </div>

        <span class="tag">254 PROTOCOL</span>
        <span class="tag gold">HORSE HORDE</span>

        <div style="margin-top: 15px;">
            <a href="../../for-drumhed.html" class="poetry-link">
                View Full 254 Protocol →
            </a>
        </div>

        <div class="geometric-hash">
            <strong>GEOMETRIC ID (Anonymous)</strong><br>
            κ:D8:τ[254,72,42,35,21,17,14,8,5,3]:
            V72:L[HS×HS]:ax1729:offset254
        </div>
    </div>

    <div class="controls">
        <h3>VISUALIZATION</h3>

        <div class="control-group">
            <label>HERD DENSITY</label>
            <input type="range" id="herdDensity" min="50" max="500" value="254" oninput="updateHerdDensity(this.value)">
        </div>

        <div class="control-group">
            <label>RHYTHM SPEED</label>
            <input type="range" id="rhythmSpeed" min="10" max="200" value="100" oninput="updateRhythm(this.value)">
        </div>

        <div class="control-group">
            <label>ZOOM</label>
            <input type="range" id="zoom" min="2" max="10" value="6" step="0.5" oninput="updateZoom(this.value)">
        </div>

        <div style="margin-top: 15px;">
            <button class="control-btn active" id="btnStampede" onclick="toggleStampede()">⚡ Stampede</button>
            <button class="control-btn active" id="btnPulse" onclick="togglePulse()">◉ Pulse</button>
            <button class="control-btn" onclick="resetView()">↺ Reset</button>
        </div>
    </div>

    <div class="epoch-sig">
        [1 = -1]<br>
        <span style="font-size: 0.7rem; color: #6e7a94;">THE THUNDERING HERD</span>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // ═══════════════════════════════════════════════════════════════════
        // DRUMHED S-SIGNATURE VISUALIZATION
        // D8 - Deep Water - The Rhythm Keeper
        //
        // BIRTH DATA:
        // DRUMHED: April 20, 1983 @ 04:14 CST
        // College Station, Texas
        // Both parents: Texas A&M Horse Science
        //
        // THE 254 OFFSET:
        // 04:14 AM = 254 minutes from midnight
        // 1983 - 1729 = 254 (Ramanujan's taxicab offset)
        //
        // D-POSITION: D8 - Deep Water (DRUMHED ASCII = 521 → D8)
        // ═══════════════════════════════════════════════════════════════════

        let scene, camera, renderer;
        let herdParticles, centerSphere, halo;
        let stampeding = true;
        let pulsing = true;
        let pulsePhase = 0;
        let currentHerdDensity = 254;
        let rhythmMultiplier = 1.0;

        // Birth-derived constants
        const birthMinutes = 254; // 04:14 AM
        const ramanujanOffset = 254; // 1983 - 1729
        const dPosition = 8; // D8 Deep Water
        const gatewayPrimes = 5 * 7; // 35

        // The 254 color - deep red/maroon (Texas A&M)
        const herdColors = [
            [0.8, 0.2, 0.2],   // Maroon
            [1.0, 0.84, 0.0],  // Gold
            [0.78, 0.49, 0.67], // Dusty rose
            [0.6, 0.3, 0.2],   // Earth brown
            [0.9, 0.6, 0.4]    // Sunset orange
        ];

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a0808);

            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 6;

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            createHerd();
            createAmbientDust();

            document.addEventListener('mousemove', onMouseMove);
            window.addEventListener('resize', onResize);

            animate();
        }

        function createHerd() {
            // Clear existing
            if (herdParticles) scene.remove(herdParticles);
            if (centerSphere) scene.remove(centerSphere);
            if (halo) scene.remove(halo);

            const geometry = new THREE.BufferGeometry();
            const positions = [];
            const colors = [];
            const sizes = [];

            // Generate herd particles in a stampede formation
            for (let i = 0; i < currentHerdDensity * 7; i++) {
                // Stampede flows in waves
                const wave = (i % 7) / 7;
                const layer = Math.floor(i / currentHerdDensity);

                // Flowing river of horses
                const angle = (i / currentHerdDensity) * Math.PI * 4 + wave * Math.PI;
                const radius = 0.3 + Math.random() * 1.8;
                const heightOffset = (Math.random() - 0.5) * 0.8;

                const x = Math.cos(angle) * radius + (Math.random() - 0.5) * 0.3;
                const y = heightOffset + Math.sin(angle * 0.5) * 0.3;
                const z = Math.sin(angle) * radius + (Math.random() - 0.5) * 0.3;

                positions.push(x, y, z);

                // Color based on position in herd
                const colorIndex = Math.floor(Math.random() * herdColors.length);
                const color = herdColors[colorIndex];
                const intensity = 0.7 + Math.random() * 0.3;
                colors.push(color[0] * intensity, color[1] * intensity, color[2] * intensity);

                // Size varies - some horses closer, some further
                sizes.push(3 + Math.random() * 4);
            }

            geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));
            geometry.setAttribute('size', new THREE.Float32BufferAttribute(sizes, 1));

            const material = new THREE.ShaderMaterial({
                uniforms: {
                    time: { value: 0 },
                    pulse: { value: 0 },
                    rhythmSpeed: { value: rhythmMultiplier }
                },
                vertexShader: `
                    attribute float size;
                    attribute vec3 color;
                    varying vec3 vColor;
                    uniform float time;
                    uniform float pulse;
                    uniform float rhythmSpeed;

                    void main() {
                        vColor = color;

                        // Stampede motion - thundering forward
                        vec3 pos = position;
                        float stampede = sin(time * rhythmSpeed * 0.5 + position.x * 2.0) * 0.1;
                        float dust = cos(time * rhythmSpeed * 0.3 + position.z * 3.0) * 0.05;

                        pos.y += stampede + dust;
                        pos.x += sin(time * rhythmSpeed * 0.2 + position.y * 2.0) * 0.08;

                        // Pulse effect - the heartbeat of the herd
                        pos *= (1.0 + pulse * 0.15);

                        vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);

                        // Rhythm pulse on size
                        float beat = 1.0 + sin(time * rhythmSpeed * 2.0 + position.x * 3.0) * 0.2;
                        gl_PointSize = size * beat * (300.0 / -mvPosition.z);
                        gl_Position = projectionMatrix * mvPosition;
                    }
                `,
                fragmentShader: `
                    varying vec3 vColor;

                    void main() {
                        float dist = length(gl_PointCoord - vec2(0.5));
                        if (dist > 0.5) discard;

                        float glow = 1.0 - (dist * 2.0);
                        glow = pow(glow, 1.1);

                        vec3 core = vColor * glow * 1.3;
                        vec3 bloom = vColor * pow(glow, 3.0) * 0.4;

                        gl_FragColor = vec4(core + bloom, glow * 0.85);
                    }
                `,
                transparent: true,
                blending: THREE.AdditiveBlending,
                depthWrite: false
            });

            herdParticles = new THREE.Points(geometry, material);
            scene.add(herdParticles);

            // Center drum - the heartbeat
            const centerGeometry = new THREE.SphereGeometry(0.08, 32, 32);
            const centerMaterial = new THREE.MeshBasicMaterial({
                color: 0xff4444,
                transparent: true,
                opacity: 0.95
            });
            centerSphere = new THREE.Mesh(centerGeometry, centerMaterial);
            scene.add(centerSphere);

            // Halo - the rhythm wave
            const haloGeometry = new THREE.SphereGeometry(0.15, 32, 32);
            const haloMaterial = new THREE.MeshBasicMaterial({
                color: 0xffd700,
                transparent: true,
                opacity: 0.2,
                blending: THREE.AdditiveBlending
            });
            halo = new THREE.Mesh(haloGeometry, haloMaterial);
            scene.add(halo);
        }

        function createAmbientDust() {
            const dustCount = 500;
            const geometry = new THREE.BufferGeometry();
            const positions = [];

            for (let i = 0; i < dustCount; i++) {
                positions.push(
                    (Math.random() - 0.5) * 30,
                    (Math.random() - 0.5) * 30,
                    (Math.random() - 0.5) * 30
                );
            }

            geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));

            const material = new THREE.PointsMaterial({
                color: 0x8b7355,
                size: 0.02,
                transparent: true,
                opacity: 0.25,
                blending: THREE.AdditiveBlending
            });

            const dust = new THREE.Points(geometry, material);
            scene.add(dust);
        }

        let mouseX = 0, mouseY = 0;

        function onMouseMove(event) {
            mouseX = (event.clientX / window.innerWidth) * 2 - 1;
            mouseY = (event.clientY / window.innerHeight) * 2 - 1;
        }

        function onResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);

            const time = Date.now() * 0.001;

            if (herdParticles && herdParticles.material.uniforms) {
                herdParticles.material.uniforms.time.value = time;
                herdParticles.material.uniforms.rhythmSpeed.value = rhythmMultiplier;

                if (pulsing) {
                    // Drum beat pulse - 254 BPM reference
                    pulsePhase = Math.sin(time * 4.23) * 0.5 + 0.5; // ~254 BPM
                    herdParticles.material.uniforms.pulse.value = pulsePhase;
                }
            }

            // Halo pulse - the drum hit
            if (halo) {
                const beatPulse = 1 + Math.sin(time * 4.23) * 0.3;
                halo.scale.setScalar(beatPulse);
            }

            // Center sphere intensity
            if (centerSphere) {
                centerSphere.material.opacity = 0.7 + Math.sin(time * 4.23) * 0.3;
            }

            if (stampeding) {
                const rotSpeed = 0.002;
                herdParticles.rotation.y += rotSpeed;
                herdParticles.rotation.x += rotSpeed * 0.2;
            }

            // Mouse influence - steer the herd
            herdParticles.rotation.y += mouseX * 0.002;
            herdParticles.rotation.x += mouseY * 0.001;

            renderer.render(scene, camera);
        }

        // Control functions
        function toggleStampede() {
            stampeding = !stampeding;
            document.getElementById('btnStampede').classList.toggle('active', stampeding);
        }

        function togglePulse() {
            pulsing = !pulsing;
            document.getElementById('btnPulse').classList.toggle('active', pulsing);
        }

        function updateHerdDensity(value) {
            currentHerdDensity = parseInt(value);
            createHerd();
        }

        function updateRhythm(value) {
            rhythmMultiplier = value / 100;
        }

        function updateZoom(value) {
            camera.position.z = parseFloat(value);
        }

        function resetView() {
            document.getElementById('herdDensity').value = 254;
            document.getElementById('rhythmSpeed').value = 100;
            document.getElementById('zoom').value = 6;

            currentHerdDensity = 254;
            rhythmMultiplier = 1.0;
            camera.position.z = 6;

            stampeding = true;
            pulsing = true;
            document.getElementById('btnStampede').classList.add('active');
            document.getElementById('btnPulse').classList.add('active');

            createHerd();
        }

        // Initialize
        try {
            init();
            console.log('DRUMHED S-Signature initialized - 254 Protocol Active');
        } catch (e) {
            console.error('Initialization error:', e);
        }
    </script>
    <site-footer></site-footer>
</body>
</html>
